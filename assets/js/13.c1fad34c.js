(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{285:function(e,t,s){"use strict";s.r(t);var a=s(13),r=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"how-to-be-safe"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#how-to-be-safe"}},[e._v("#")]),e._v(" How To Be Safe?")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Map root in container to a user without privilege.")]),e._v(" "),t("p",[t("strong",[e._v("Attention")]),e._v(":All images and containers may be removed, backup if necessary.")]),e._v(" "),t("blockquote",[t("p",[e._v("Refer to:https://docs.docker.com/engine/security/userns-remap/")]),e._v(" "),t("p",[e._v("If you encounter problems, refer to:https://docs.docker.com/engine/security/rootless/#troubleshooting")]),e._v(" "),t("p",[e._v("If Docker also needs to run other application containers, the corresponding container needs to be executed in "),t("strong",[e._v("host")]),e._v(" mode.")])]),e._v(" "),t("p",[e._v("Add to "),t("code",[e._v("/etc/docker/daemon.json")]),e._v(", and restart docker service.")]),e._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"userns-remap"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"default"')]),e._v("\n")])])]),t("p",[e._v("Then "),t("code",[e._v("grep dockremap /etc/subuid")]),e._v(", you will get at least a line, and docker containers can be start nornally:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("dockremap:100000:65535\n")])])])]),e._v(" "),t("li",[t("p",[e._v("Seccomp Restriction")]),e._v(" "),t("blockquote",[t("p",[e._v("Ref:https://docs.docker.com/engine/security/seccomp/")])]),e._v(" "),t("p",[e._v("Use seccomp security profile "),t("code",[e._v("seccomp/default.json")]),e._v(", add options when run:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("--security-opt "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("seccomp")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/path/to/files/seccomp/default.json\n")])])]),t("p",[e._v("Docker provides with "),t("a",{attrs:{href:"https://github.com/moby/moby/blob/master/profiles/seccomp/default.json",target:"_blank",rel:"noopener noreferrer"}},[e._v("default.json"),t("OutboundLink")],1),e._v(" as sample, DJudger provides with "),t("a",{attrs:{href:"https://github.com/NicerWang/DJudger/blob/master/seccomp/default.json",target:"_blank",rel:"noopener noreferrer"}},[e._v("default.json"),t("OutboundLink")],1),e._v(" at a smaller whitelist scope.")])]),e._v(" "),t("li",[t("p",[e._v("Restore")]),e._v(" "),t("p",[e._v("Run testcode after each run, remove and run a new container if test failed.")]),e._v(" "),t("p",[e._v("If container wasn't broken(test passed), it will be reused.")])]),e._v(" "),t("li",[t("p",[e._v("Time Limit")]),e._v(" "),t("p",[e._v("Remove and run a new container if TLE (Run or Compile) .")])]),e._v(" "),t("li",[t("p",[e._v("Network")]),e._v(" "),t("p",[e._v("Container should not be linked with any network, add options when run:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--network")]),e._v(" none\n")])])])]),e._v(" "),t("li",[t("p",[e._v("CPU&Process")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--cpus")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\n--pids-limit "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("30")]),e._v("\n")])])])])])])}),[],!1,null,null,null);t.default=r.exports}}]);